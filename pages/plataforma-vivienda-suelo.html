<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Plataforma de La Brújula</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header class="p-3 text-bg-dark">
        <div class="container">
            <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start"> <a
                    href="#" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none"> <img
                        class="bi me-2" width="40" height="40" role="img" aria-label="La Brújula"
                        src="../assets/img/logo-base.png"></img>
                </a>
                <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                    <li><a href="../index.html" class="nav-link px-2 text-secondary">La Brújula</a></li>
                    <li><a href="./metodologia.html" class="nav-link px-2 text-white">Metodología</a></li>
                    <li><a href="#" class="nav-link px-2 text-white">Plataforma</a></li>
                    <li><a href="#" class="nav-link px-2 text-white">Observatorio</a></li>
                    <li><a href="./contacto.html" class="nav-link px-2 text-white">Contacto</a></li>
                </ul>
                <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search"> <input type="search"
                        class="form-control form-control-dark text-bg-dark" placeholder="Search..." aria-label="Search">
                </form>
                <div class="text-end"> <button type="button" class="btn btn-outline-light me-2">Iniciar sesión</button>
                    <button type="button" class="btn btn-warning">Registrarse</button>
                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="container">
            <h2 class="titulo-plataforma">PLATAFORMA DE LA BRÚJULA</h2>
        </div>
        <div class="container">
        <div class="container">
            <nav aria-label="...">
                <ul class="pagination justify-content-between">
                    <li class="page-item active"><a class="page-link" href="#" aria-current="page">VIVIENDA Y
                            SUELO</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="./plataforma-infraestructura.html" aria-current="page">INFRAESTRUCTURAS</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="./plataforma-equipamiento.html">EQUIPAMIENTOS</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="./plataforma-accesibilidad.html">ACCESIBILIDAD</a>
                    </li>
                    <li class="page-item"><a href="./plataforma-desarrollo-local.html" class="page-link">DESARROLLO
                            LOCAL</a></li>
                </ul>
            </nav>
        </div>
            <div class="container">
                <h3>Departamento de Santa María</h3>
                <p>Seleccionar el área de interés.</p>
            </div>
            <div class="container">
                <!-- Selector de área de interés con id para llenarlo dinámicamente -->
                <select id="selector-area" class="form-select form-select-sm" aria-label="Seleccionar área de interés">
                    <!-- Opciones cargadas dinámicamente -->
                </select>
            </div>
            <div class="container">
                <hr>
            </div>
            <div class="container">
                <h3>Gráfico de La Brújula según variable</h3>
                <p>Seleccionar la variables de interés.</p>

                <!-- Selector de variable -->
                <label for="selector">Seleccionar variable:</label>
                <select id="selector"></select>

                <!-- Tabla -->
                <table id="tabla">
                    <thead>
                        <tr>
                            <th>VARIABLE</th>
                            <th>DERECHOS</th>
                            <th>ORGANIZACIÓN SOCIAL</th>
                            <th>OBRAS PÚBLICAS</th>
                            <th>NORMATIVA</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>

            </div>
            <div class="container">
                <hr>
            </div>
            <div class="container">
                <h3>Espacialización de resultados</h3>
                <p>Provisión de agua potable disponible.</p>
            </div>
            <div class="container">
                <iframe src="./mapa.html" width="100%" height="600px" style="border:none;"></iframe>
            </div>
            <div class="container">
                <hr>
            </div>
            <div class="container">
                <h3>Matriz de resultados ponderados de la dimensión de infraestructura</h3>
                <table class="table table-striped table-hover" id="tabla">
                    <thead>
                        <tr>
                            <th>Variable</th>
                            <th>Derechos</th>
                            <th>Organización social</th>
                            <th>Obras públicas</th>
                            <th>Normativa</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="container">
                <hr>
            </div>
            <div class="container">
                <h3>Conclusiones</h3>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores perspiciatis nulla nobis
                    similique facere quis? Minima quia at officia voluptatibus atque, blanditiis, officiis pariatur
                    beatae distinctio rem porro mollitia dolorem.</p>
                <br>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores perspiciatis nulla nobis
                    similique facere quis? Minima quia at officia voluptatibus atque, blanditiis, officiis pariatur
                    beatae distinctio rem porro mollitia dolorem.</p>
                <br>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores perspiciatis nulla nobis
                    similique facere quis? Minima quia at officia voluptatibus atque, blanditiis, officiis pariatur
                    beatae distinctio rem porro mollitia dolorem.</p>
            </div>
    </main>
    <div class="container">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
            <div class="col-md-4 d-flex align-items-center"> <a href="../index.html"
                    class="mb-3 me-2 mb-md-0 text-body-secondary text-decoration-none lh-1" aria-label="La Brújula">
                    <img class="bi" width="24" height="24" src="../assets/img/logo-base.png">
                    </img> </a> <span class="mb-3 mb-md-0 text-body-secondary">© 2025 La Brújula</span> </div>
            <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
                <li><a href="#"><img width="30" height="30" src="../assets/icons/linkedin.png" alt="Linkedin"></a></li>
                <li><a href="#"><img width="30" height="30" src="../assets/icons/x.png" alt="X"></a></li>
                <li><a href="#"><img width="30" height="30" src="../assets/icons/youtube.png" alt="Youtube"></a></li>
            </ul>
        </footer>

        <script>
            let chart = null;

            fetch('../json/santa-maria.json')
                .then(response => response.json())
                .then(jsonData => {
                    const data = Object.values(jsonData);

                    const selectorArea = document.getElementById('selector-area');
                    const selectorVariable = document.getElementById('selector');
                    const tbody = document.querySelector('#tabla tbody');

                    // Obtener valores únicos de ESCALA para el selector de área
                    const areasUnicas = [...new Set(data.map(row => row.ESCALA))];

                    // Cargar selector de área
                    selectorArea.innerHTML = '';
                    areasUnicas.forEach(area => {
                        const option = document.createElement('option');
                        option.value = area;
                        option.textContent = area;
                        selectorArea.appendChild(option);
                    });

                    // Función para llenar selector de variables según área seleccionada
                    function llenarVariables(area) {
                        selectorVariable.innerHTML = '';
                        const filtrados = data.filter(d => d.ESCALA === area);
                        const variablesUnicas = [...new Set(filtrados.map(f => f.VARIABLE))];
                        variablesUnicas.forEach(variable => {
                            const option = document.createElement('option');
                            option.value = variable;
                            option.textContent = variable;
                            selectorVariable.appendChild(option);
                        });
                    }

                    // Función para llenar tabla según variable y área seleccionada
                    function llenarTabla(variable, area) {
                        tbody.innerHTML = '';
                        const fila = data.find(d => d.VARIABLE === variable && d.ESCALA === area);
                        if (!fila) return;

                        const tr = document.createElement('tr');
                        ['VARIABLE', 'DERECHOS', 'ORGANIZACIÓN SOCIAL', 'OBRAS PÚBLICAS', 'NORMATIVA'].forEach(key => {
                            const td = document.createElement('td');
                            td.textContent = fila[key] || '';
                            tr.appendChild(td);
                        });
                        tbody.appendChild(tr);
                    }

                    // Inicialización: primer área y variables
                    if (areasUnicas.length > 0) {
                        const primerArea = areasUnicas[0];
                        selectorArea.value = primerArea;
                        llenarVariables(primerArea);

                        const vars = selectorVariable.options;
                        if (vars.length > 0) {
                            llenarTabla(vars[0].value, primerArea);
                        }
                    }

                    // Evento cambio en selector área para actualizar variables y tabla
                    selectorArea.addEventListener('change', () => {
                        const areaSeleccionada = selectorArea.value;
                        llenarVariables(areaSeleccionada);

                        const vars = selectorVariable.options;
                        if (vars.length > 0) {
                            llenarTabla(vars[0].value, areaSeleccionada);
                        } else {
                            tbody.innerHTML = '';
                        }
                    });

                    // Evento cambio en selector variable para actualizar tabla
                    selectorVariable.addEventListener('change', () => {
                        const areaSeleccionada = selectorArea.value;
                        const variableSeleccionada = selectorVariable.value;
                        llenarTabla(variableSeleccionada, areaSeleccionada);
                    });
                });
        </script>
    </div>
</body>

</html>